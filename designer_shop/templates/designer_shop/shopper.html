{% extends "designer_shop/shopperbase.html" %}
{% load thumbnail %}
{% load purchase_info_tags %}
{% load bleach_tags %}

{% block css %}
    {{ block.super }}
{% endblock css %}

{% block content %}
    {{ block.super }}

{#<div class="container">#}
    <div class="navbar2 navbar-default shopBackgroundColor">
{#        <div class="container row-xs-height ">#}
{#			<div id="buttonContainer" class="container col-xs-12 container-xs-height">#}
{#                <!-- Brand and toggle get grouped for better mobile display -->#}
{#                <div class="col-xs-2">#}
{#                    <a class="shopMenuBar" href="{{ shop.get_absolute_url }}">{{ shop.name }}</a>#}
{#                </div>#}
{#                <div class="col-xs-offset-6 col-xs-2">#}
{#                    <a class="shopTabLink active" data-toggle="tab" href="#shopTab">Shop</a>#}
{#                </div>#}
{#                <div class="col-xs-2">#}
{#                    {% if user.email == shop.user.email%}#}
{#                        <a id="editLink" href="{{ shop.get_absolute_url }}edit">Edit Shop</a>#}
{#                    {% endif %}#}
{#                </div>#}
{#                <div class="col-xs-2">#}
{#                    <a id="aboutTabLink" href="#aboutTab"  role="tab" data-toggle="tab">About</a></li>#}
{#                </div>#}
{#            </div>#}
            <div class="navbar-header">

				<a class="navbar-brand" href="{{ shop.get_absolute_url }}">{{ shop.name }}</a>
                <div class="shopMenuBar">
                    <a class="navbar-brand" data-toggle="tab" href="#shopTab">Shop</a>
                    <a class="navbar-brand" id="aboutTabAnchorXS" href="#aboutTab"  role="tab" data-toggle="tab">About</a>
                </div>
{#                <div class=" collapse navbar-collapse" id="">#}
{#                <ul class="visible-xs nav pull-right">#}
{#					<li class="shopTabLink active" ><a data-toggle="tab" href="#shopTab">Shop</a></li>#}
{#                    {% if user.email == shop.user.email%}#}
{#                        <li id="editLink"><a  href="{{ shop.get_absolute_url }}edit">Edit Shop</a></li>#}
{#                    {% endif %}#}
{#					<li id="aboutTabLink"><a id="aboutTabAnchorXS" href="#aboutTab"  role="tab" data-toggle="tab">About</a></li>#}
{#				</ul>#}
{#                </div>#}
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
{#			<div class="collapse navbar-collapse" id="">#}
{#				<ul class="nav navbar-nav">#}
{#					<li class="shopTabLink active" ><a data-toggle="tab" href="#shopTab">Shop</a></li>#}
{#                    {% if user.email == shop.user.email%}#}
{#                        <li id="editLink"><a  href="{{ shop.get_absolute_url }}edit">Edit Shop</a></li>#}
{#                    {% endif %}#}
{#					<li id="aboutTabLink"><a id="aboutTabAnchor" href="#aboutTab"  role="tab" data-toggle="tab">About</a></li>#}
{#				</ul>#}
{#			</div><!-- /.navbar-collapse -->#}
{#        </div>#}
    </div><!-- /.container-fluid -->

    <div class="tab-content ">
        <div class=" tab-pane active" id="shopTab">
            <div class="container comboBoxes">
                <div class="row">
                    <div class="col-xs-offset-1 col-xs-10 col-sm-offset-1 col-sm-3 col-md-offset-3 col-md-2">
                        <select class="select form-control filterTabs" id="filterGender" name="genderFilter">
                            <option value="View All">View All</option>
                            {% for genders in shopgenders %}
                                <option value="{{ genders.name }}">{{ genders.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col-xs-offset-1 col-xs-10 col-sm-offset-0 col-sm-3 col-md-2">
                        <select class="select form-control filterTabs" id="filterType" name="typeFilter">
                            <option value="View All Types">View All Types</option>
                            {% for category in shopcategories %}
                                <option value="{{ category }}">{{ category }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col-xs-offset-1 col-xs-10 col-sm-offset-0 col-sm-3 col-md-2">
                        <select class="select form-control filterTabs" id="filterSort" name="sortFilter">
                            <option value="no-sort">No Sorting</option>
                            <option value="date-asc">Newest First</option>
                            <option value="date-dsc">Oldest First</option>
                            <option value="price-asc">Price: Low to High</option>
                            <option value="price-dsc">Price: High to Low</option>
                            <option value="pop-asc">Popularity: Low to High</option>
                            <option value="pop-dsc">Popularity: High to Low</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="container">
                {% include "designer_shop/shop_items.html" %}
            </div>
        </div>
        <div class=" tab-pane" id="aboutTab">
            <div class="container">
                <div class="row">
                    <div class="col-xs-offset-1 col-xs-10 col-sm-offset-0 col-sm-2 aboutContent" style="padding-top: 20px">
                        {% if shop.aboutImg %}
                            <img id="displayedAboutImg" class="full-screen" src="{{shop.aboutImg.url}}"  />
                        {% endif %}
                    </div>
                    <div class="col-xs-offset-1 col-xs-10 col-sm-offset-0 col-sm-8 aboutContent">
                        {{ shop.aboutContent | bleach }}
                    </div>
                </div>
            </div>
        </div>
    </div>
{#</div>#}

{% endblock %}

{% block javascript %}
    {{ block.super }}
    <script>

    $('#filterGender').change( function() {updateItemView(true)})
    $('#filterType').change( function() {updateItemView(false)})
    $('#filterSort').change( function() {updateItemView(false)})

    function updateItemView(changeGender){
        var genderFilter = $("#filterGender option:selected").attr("value");
        var typeFilter = $("#filterType option:selected").attr("value");
        var sortFilter = $("#filterSort option:selected").attr("value");
        $("#shopItems").load(" #shopItems", {genderfilter: genderFilter, typefilter: typeFilter, sortfilter: sortFilter}, function(){$(this).children().unwrap()});
        if (genderFilter.match("All"))
            genderFilter = "All"
        if (changeGender)
            refreshtypes(genderFilter);
    }
var myresponse;
    function refreshtypes(genderFilter) {
        myresponse = $.getJSON( "{{ request.get_full_path }}getTypes/" + genderFilter, function(data) {
            var list = [];
            list.push('<option value="View All Types"><i>View All Types</i></option>');
            $.each(data.types, function(key, value)
            {
                list.push('<option value="'+ value +'">'+ value +'</option>');
            });
            $('#filterType').html(list.join(''));
            $('#filterType').val("View All Types");
        });
    }

    </script>
{% endblock %}

